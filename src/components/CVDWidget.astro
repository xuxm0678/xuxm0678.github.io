

<div
  id="cvd-widget"
  class="w-[360px] sm:w-[400px] lg:w-[440px] rounded-2xl bg-[#0f1115] p-6 shadow-[0_28px_80px_-18px_rgba(0,0,0,0.55)] text-white transition-transform duration-300 will-change-transform"
>
  <h3 class="text-lg font-semibold tracking-tight">Cardiovascular Risk</h3>

  <p id="risk-value" class="mt-2 text-6xl font-extrabold bg-gradient-to-r from-cyan-300 to-blue-400 bg-clip-text text-transparent tracking-tight">
    25%
  </p>

  <div
    id="risk-badge"
    class="mt-2 inline-block text-xs font-bold px-3 py-1 rounded-full border bg-green-500/20 text-green-300 border-green-500/50"
  >
    LOW RISK
  </div>

  <hr class="my-5 border-white/10" />

  <p class="text-sm text-gray-400 mb-2">Key Factors</p>
  <div class="flex justify-between text-sm"><span>Age</span><span id="factor-age">45</span></div>
  <div class="flex justify-between text-sm"><span>BMI</span><span id="factor-bmi">24</span></div>
  <div class="flex justify-between text-sm"><span>Sleep Efficiency</span><span id="factor-sleep">82%</span></div>

  <hr class="my-5 border-white/10" />

  <a href="/projects/cvd-risk/demo" class="text-cyan-300 font-semibold hover:underline text-sm">Open Full Demo →</a>
</div>

<script>
  // ✅ Smooth tween number updates
  function tween(el, newValue, suffix = "") {
    const start = parseInt(el.textContent);
    const diff = newValue - start;
    const duration = 900;
    const startTime = performance.now();

    const tick = () => {
      const now = performance.now();
      const progress = Math.min((now - startTime) / duration, 1);
      const value = Math.round(start + diff * progress);
      el.textContent = value + suffix;
      if (progress < 1) requestAnimationFrame(tick);
    };
    requestAnimationFrame(tick);
  }

  // ✅ Risk badge color & label mapping
  function updateRiskBadge(risk) {
    const badge = document.getElementById("risk-badge");
    if (risk <= 30) {
      badge.textContent = "LOW RISK";
      badge.className = base + " bg-green-500/20 text-green-300 border-green-500/50";
    } else if (risk <= 60) {
      badge.textContent = "MODERATE RISK";
      badge.className = base + " bg-yellow-500/20 text-yellow-300 border-yellow-500/50";
    } else {
      badge.textContent = "HIGH RISK";
      badge.className = base + " bg-red-500/20 text-red-300 border-red-500/50";
    }
  }
  const base = "mt-2 inline-block text-xs font-bold px-3 py-1 rounded-full border";

  // ✅ Auto animate every 2.8s
  function animateValues() {
    const risk = Math.floor(Math.random() * 75) + 5;
    const age = 35 + Math.floor(Math.random() * 30);
    const bmi = 18 + Math.floor(Math.random() * 12);
    const sleep = 70 + Math.floor(Math.random() * 25);

    tween(document.getElementById("risk-value"), risk, "%");
    tween(document.getElementById("factor-age"), age);
    tween(document.getElementById("factor-bmi"), bmi);
    tween(document.getElementById("factor-sleep"), sleep, "%");
    updateRiskBadge(risk);
  }

  setInterval(animateValues, 2800);

  // ✅ Hover Tilt
  const wrap = document.getElementById("cvd-widget");
  wrap.addEventListener("mousemove", (e) => {
    const r = wrap.getBoundingClientRect();
    const x = (e.clientX - r.left) / r.width;
    const y = (e.clientY - r.top) / r.height;
    wrap.style.transform = `rotateX(${(0.5 - y) * 10}deg) rotateY(${(x - 0.5) * 14}deg) scale(1.05)`;
  });
  wrap.addEventListener("mouseleave", () => {
    wrap.style.transform = "rotateX(0deg) rotateY(0deg) scale(1)";
  });
</script>
